--data_dir=./MSLR_10k_letor/tmp_data/ --model_dir=./MSLR_10k_letor/tmp_model_singlet_pointwiseem_batch1024/ --output_dir=./MSLR_10k_letor/tmp_output/ --setting_file=./example/offline_setting/pointwise_regression_EM_exp_settings.json
WARNING:tensorflow:From main.py:272: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From main.py:107: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

W0701 13:48:37.678847 140475313563456 module_wrapper.py:139] From main.py:107: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From main.py:109: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

W0701 13:48:37.679215 140475313563456 module_wrapper.py:139] From main.py:109: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2021-07-01 13:48:37.679840: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2021-07-01 13:48:37.687120: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2494140000 Hz
2021-07-01 13:48:37.687470: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x509ff60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-01 13:48:37.687493: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:99: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0701 13:48:37.693600 140475313563456 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:99: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/base_algorithm.py:118: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

W0701 13:48:41.600780 140475313563456 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/base_algorithm.py:118: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/ranking_model/DNN.py:62: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

W0701 13:48:43.899345 140475313563456 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/ranking_model/DNN.py:62: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/ranking_model/DNN.py:63: The name tf.AUTO_REUSE is deprecated. Please use tf.compat.v1.AUTO_REUSE instead.

W0701 13:48:43.899810 140475313563456 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/ranking_model/DNN.py:63: The name tf.AUTO_REUSE is deprecated. Please use tf.compat.v1.AUTO_REUSE instead.

WARNING:tensorflow:From /usr/local/lib64/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
W0701 13:48:44.015205 140475313563456 deprecation.py:506] From /usr/local/lib64/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/ranking_model/base_ranking_model.py:121: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

W0701 13:48:44.043805 140475313563456 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/ranking_model/base_ranking_model.py:121: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/base_algorithm.py:85: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
W0701 13:48:46.625498 140475313563456 deprecation.py:323] From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/base_algorithm.py:85: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/utils/metrics.py:278: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
W0701 13:48:53.169556 140475313563456 deprecation.py:323] From /data/violatang/l2r-paper/code/ULTRA/ultra/utils/metrics.py:278: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:122: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

W0701 13:48:53.226942 140475313563456 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:122: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/utils/metrics.py:172: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0701 13:48:53.949310 140475313563456 deprecation.py:323] From /data/violatang/l2r-paper/code/ULTRA/ultra/utils/metrics.py:172: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:143: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

W0701 13:48:55.432533 140475313563456 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:143: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:409: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
W0701 13:48:55.489300 140475313563456 deprecation.py:506] From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:409: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:48: The name tf.ceil is deprecated. Please use tf.math.ceil instead.

W0701 13:48:55.514957 140475313563456 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:48: The name tf.ceil is deprecated. Please use tf.math.ceil instead.

WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:48: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0701 13:48:55.515175 140475313563456 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:48: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:171: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

W0701 13:48:55.528131 140475313563456 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:171: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:177: The name tf.train.AdagradOptimizer is deprecated. Please use tf.compat.v1.train.AdagradOptimizer instead.

W0701 13:48:55.528383 140475313563456 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:177: The name tf.train.AdagradOptimizer is deprecated. Please use tf.compat.v1.train.AdagradOptimizer instead.

WARNING:tensorflow:From /usr/local/lib64/python3.6/site-packages/tensorflow_core/python/training/adagrad.py:76: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
W0701 13:48:56.253013 140475313563456 deprecation.py:506] From /usr/local/lib64/python3.6/site-packages/tensorflow_core/python/training/adagrad.py:76: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
INFO:tensorflow:Summary name Gradient Norm is illegal; using Gradient_Norm instead.
I0701 13:48:56.377533 140475313563456 summary_op_util.py:66] Summary name Gradient Norm is illegal; using Gradient_Norm instead.
INFO:tensorflow:Summary name Learning Rate is illegal; using Learning_Rate instead.
I0701 13:48:56.379491 140475313563456 summary_op_util.py:66] Summary name Learning Rate is illegal; using Learning_Rate instead.
WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:227: The name tf.summary.merge_all is deprecated. Please use tf.compat.v1.summary.merge_all instead.

W0701 13:48:57.298073 140475313563456 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:227: The name tf.summary.merge_all is deprecated. Please use tf.compat.v1.summary.merge_all instead.

WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:229: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

W0701 13:48:57.318403 140475313563456 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:229: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:229: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.

W0701 13:48:57.318632 140475313563456 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:229: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.

WARNING:tensorflow:From main.py:74: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

W0701 13:48:57.383358 140475313563456 module_wrapper.py:139] From main.py:74: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From main.py:123: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

W0701 13:48:58.761506 140475313563456 module_wrapper.py:139] From main.py:123: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2021-07-01 13:49:47.338713: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 505806848 exceeds 10% of system memory.
2021-07-01 13:49:47.443409: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 505806848 exceeds 10% of system memory.
2021-07-01 13:49:47.595158: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 505806848 exceeds 10% of system memory.
2021-07-01 13:49:47.664039: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 505806848 exceeds 10% of system memory.
2021-07-01 13:49:47.938315: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 1904214016 exceeds 10% of system memory.
WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/utils/data_utils.py:367: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.

W0701 13:50:03.885955 140475313563456 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/utils/data_utils.py:367: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.

Reading data in ./MSLR_10k_letor/tmp_data/
Read data from ./MSLR_10k_letor/tmp_data//train in ULTRA format.
Feature reading finish.
List reading finish.
Label reading finish.
Remove 183 invalid queries.
Data reading finish!
Finished reading 5817 queries with lists.
Read data from ./MSLR_10k_letor/tmp_data//valid in ULTRA format.
Feature reading finish.
List reading finish.
Label reading finish.
Remove 0 invalid queries.
Data reading finish!
Finished reading 1939 queries with lists.
Train Rank list size 809
Valid Rank list size 908
Users can only see the top 10 documents for each query in training.
Creating model...
Build Pairwise RegressionEM algorithm.
pointwise_only=True
<ultra.utils.losses_impl.DCGLambdaWeight object at 0x7fc2d5425898>
ranking_model: <class 'ultra.ranking_model.DNN.DNN'>
kwargs: {'rank_list_size': 908, 'forward_only': False}
kwargs: {'rank_list_size': 10, 'forward_only': False}
kwargs: {'rank_list_size': 10, 'forward_only': False}
Created model with fresh parameters.
Create simluated clicks feed

Create direct label feed with list size 908 with feature size 136
global step 50 learning rate 0.0500 step-time 0.69 loss 5.3759
  valid: mrr_3:0.630 mrr_5:0.630 mrr_10:0.630 ndcg_3:0.164 ndcg_5:0.182 ndcg_10:0.221
Save model, valid ndcg_10:0.221
global step 100 learning rate 0.0500 step-time 0.44 loss 4.3685
  valid: mrr_3:0.631 mrr_5:0.631 mrr_10:0.631 ndcg_3:0.164 ndcg_5:0.182 ndcg_10:0.221
Save model, valid ndcg_10:0.221
global step 150 learning rate 0.0500 step-time 0.50 loss 4.4319
  valid: mrr_3:0.631 mrr_5:0.631 mrr_10:0.631 ndcg_3:0.164 ndcg_5:0.183 ndcg_10:0.221
global step 200 learning rate 0.0500 step-time 0.38 loss 4.5123
  valid: mrr_3:0.631 mrr_5:0.631 mrr_10:0.631 ndcg_3:0.164 ndcg_5:0.182 ndcg_10:0.221
global step 250 learning rate 0.0500 step-time 0.37 loss 4.6308
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.165 ndcg_5:0.183 ndcg_10:0.221
Save model, valid ndcg_10:0.221
global step 300 learning rate 0.0500 step-time 0.38 loss 4.7376
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.165 ndcg_5:0.183 ndcg_10:0.222
Save model, valid ndcg_10:0.222
global step 350 learning rate 0.0500 step-time 0.38 loss 4.8647
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.165 ndcg_5:0.183 ndcg_10:0.222
Save model, valid ndcg_10:0.222
WARNING:tensorflow:From /usr/local/lib64/python3.6/site-packages/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
W0701 13:54:31.801467 140475313563456 deprecation.py:323] From /usr/local/lib64/python3.6/site-packages/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
global step 400 learning rate 0.0500 step-time 0.38 loss 4.9822
  valid: mrr_3:0.633 mrr_5:0.633 mrr_10:0.633 ndcg_3:0.165 ndcg_5:0.183 ndcg_10:0.222
Save model, valid ndcg_10:0.222
global step 450 learning rate 0.0500 step-time 0.38 loss 5.1123
  valid: mrr_3:0.633 mrr_5:0.633 mrr_10:0.633 ndcg_3:0.165 ndcg_5:0.183 ndcg_10:0.222
Save model, valid ndcg_10:0.222
global step 500 learning rate 0.0500 step-time 0.38 loss 5.2125
  valid: mrr_3:0.633 mrr_5:0.633 mrr_10:0.633 ndcg_3:0.165 ndcg_5:0.183 ndcg_10:0.222
Save model, valid ndcg_10:0.222
global step 550 learning rate 0.0500 step-time 0.38 loss 5.2900
  valid: mrr_3:0.633 mrr_5:0.633 mrr_10:0.633 ndcg_3:0.165 ndcg_5:0.183 ndcg_10:0.222
Save model, valid ndcg_10:0.222
global step 600 learning rate 0.0500 step-time 0.42 loss 5.3579
  valid: mrr_3:0.633 mrr_5:0.633 mrr_10:0.633 ndcg_3:0.166 ndcg_5:0.183 ndcg_10:0.223
Save model, valid ndcg_10:0.223
global step 650 learning rate 0.0500 step-time 0.38 loss 5.4225
  valid: mrr_3:0.633 mrr_5:0.633 mrr_10:0.633 ndcg_3:0.166 ndcg_5:0.184 ndcg_10:0.223
Save model, valid ndcg_10:0.223
global step 700 learning rate 0.0500 step-time 0.38 loss 5.5052
  valid: mrr_3:0.633 mrr_5:0.633 mrr_10:0.633 ndcg_3:0.166 ndcg_5:0.184 ndcg_10:0.223
Save model, valid ndcg_10:0.223
global step 750 learning rate 0.0500 step-time 0.38 loss 5.5437
  valid: mrr_3:0.633 mrr_5:0.633 mrr_10:0.633 ndcg_3:0.166 ndcg_5:0.184 ndcg_10:0.223
global step 800 learning rate 0.0500 step-time 0.38 loss 5.5825
  valid: mrr_3:0.633 mrr_5:0.633 mrr_10:0.633 ndcg_3:0.165 ndcg_5:0.184 ndcg_10:0.223
Save model, valid ndcg_10:0.223
global step 850 learning rate 0.0500 step-time 0.38 loss 5.6245
  valid: mrr_3:0.633 mrr_5:0.633 mrr_10:0.633 ndcg_3:0.165 ndcg_5:0.184 ndcg_10:0.223
Save model, valid ndcg_10:0.223
global step 900 learning rate 0.0500 step-time 0.38 loss 5.6364
  valid: mrr_3:0.633 mrr_5:0.633 mrr_10:0.633 ndcg_3:0.166 ndcg_5:0.185 ndcg_10:0.223
Save model, valid ndcg_10:0.223
global step 950 learning rate 0.0500 step-time 0.38 loss 5.6720
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.165 ndcg_5:0.184 ndcg_10:0.223
global step 1000 learning rate 0.0500 step-time 0.38 loss 5.7085
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.166 ndcg_5:0.184 ndcg_10:0.223
Save model, valid ndcg_10:0.223
global step 1050 learning rate 0.0500 step-time 0.38 loss 5.7123
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.165 ndcg_5:0.184 ndcg_10:0.223
global step 1100 learning rate 0.0500 step-time 0.37 loss 5.7319
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.165 ndcg_5:0.184 ndcg_10:0.223
global step 1150 learning rate 0.0500 step-time 0.41 loss 5.7522
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.166 ndcg_5:0.184 ndcg_10:0.223
global step 1200 learning rate 0.0500 step-time 0.38 loss 5.7726
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.165 ndcg_5:0.184 ndcg_10:0.223
global step 1250 learning rate 0.0500 step-time 0.38 loss 5.7747
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.166 ndcg_5:0.184 ndcg_10:0.223
global step 1300 learning rate 0.0500 step-time 0.38 loss 5.7985
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.166 ndcg_5:0.184 ndcg_10:0.223
global step 1350 learning rate 0.0500 step-time 0.38 loss 5.8056
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.165 ndcg_5:0.184 ndcg_10:0.223
global step 1400 learning rate 0.0500 step-time 0.38 loss 5.8053
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.166 ndcg_5:0.184 ndcg_10:0.223
global step 1450 learning rate 0.0500 step-time 0.38 loss 5.8119
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.166 ndcg_5:0.184 ndcg_10:0.223
Save model, valid ndcg_10:0.223
global step 1500 learning rate 0.0500 step-time 0.38 loss 5.8369
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.166 ndcg_5:0.184 ndcg_10:0.223
Save model, valid ndcg_10:0.223
global step 1550 learning rate 0.0500 step-time 0.37 loss 5.8339
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.166 ndcg_5:0.184 ndcg_10:0.223
global step 1600 learning rate 0.0500 step-time 0.38 loss 5.8530
  valid: mrr_3:0.631 mrr_5:0.631 mrr_10:0.631 ndcg_3:0.166 ndcg_5:0.184 ndcg_10:0.223
global step 1650 learning rate 0.0500 step-time 0.38 loss 5.8841
  valid: mrr_3:0.631 mrr_5:0.631 mrr_10:0.631 ndcg_3:0.166 ndcg_5:0.184 ndcg_10:0.223
global step 1700 learning rate 0.0500 step-time 0.42 loss 5.8793
  valid: mrr_3:0.631 mrr_5:0.631 mrr_10:0.631 ndcg_3:0.166 ndcg_5:0.184 ndcg_10:0.223
global step 1750 learning rate 0.0500 step-time 0.37 loss 5.8723
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.166 ndcg_5:0.184 ndcg_10:0.223
Save model, valid ndcg_10:0.223
global step 1800 learning rate 0.0500 step-time 0.37 loss 5.9024
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.165 ndcg_5:0.184 ndcg_10:0.223
global step 1850 learning rate 0.0500 step-time 0.38 loss 5.8770
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.166 ndcg_5:0.184 ndcg_10:0.223
Save model, valid ndcg_10:0.223
global step 1900 learning rate 0.0500 step-time 0.37 loss 5.8971
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.166 ndcg_5:0.185 ndcg_10:0.223
Save model, valid ndcg_10:0.223
global step 1950 learning rate 0.0500 step-time 0.38 loss 5.8898
  valid: mrr_3:0.632 mrr_5:0.632 mrr_10:0.632 ndcg_3:0.166 ndcg_5:0.185 ndcg_10:0.223
global step 2000 learning rate 0.0500 step-time 0.38 loss 5.9084
  valid: mrr_3:0.633 mrr_5:0.633 mrr_10:0.633 ndcg_3:0.166 ndcg_5:0.185 ndcg_10:0.224
Save model, valid ndcg_10:0.224
global step 2050 learning rate 0.0500 step-time 0.38 loss 5.8931
  valid: mrr_3:0.633 mrr_5:0.633 mrr_10:0.633 ndcg_3:0.166 ndcg_5:0.185 ndcg_10:0.223
WARNING:tensorflow:From main.py:272: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From main.py:207: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

W0701 14:14:36.849296 140463410571072 module_wrapper.py:139] From main.py:207: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From main.py:209: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

W0701 14:14:36.849514 140463410571072 module_wrapper.py:139] From main.py:209: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2021-07-01 14:14:36.850034: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2021-07-01 14:14:36.854935: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2494140000 Hz
2021-07-01 14:14:36.855333: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x48d1a10 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-01 14:14:36.855356: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:99: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0701 14:15:16.607420 140463410571072 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:99: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/base_algorithm.py:118: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

W0701 14:15:17.081275 140463410571072 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/base_algorithm.py:118: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/ranking_model/DNN.py:62: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

W0701 14:15:17.993216 140463410571072 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/ranking_model/DNN.py:62: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/ranking_model/DNN.py:63: The name tf.AUTO_REUSE is deprecated. Please use tf.compat.v1.AUTO_REUSE instead.

W0701 14:15:17.993467 140463410571072 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/ranking_model/DNN.py:63: The name tf.AUTO_REUSE is deprecated. Please use tf.compat.v1.AUTO_REUSE instead.

WARNING:tensorflow:From /usr/local/lib64/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
W0701 14:15:18.026236 140463410571072 deprecation.py:506] From /usr/local/lib64/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/ranking_model/base_ranking_model.py:121: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

W0701 14:15:18.039939 140463410571072 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/ranking_model/base_ranking_model.py:121: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/base_algorithm.py:85: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
W0701 14:15:19.642240 140463410571072 deprecation.py:323] From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/base_algorithm.py:85: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/utils/metrics.py:278: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
W0701 14:15:21.726965 140463410571072 deprecation.py:323] From /data/violatang/l2r-paper/code/ULTRA/ultra/utils/metrics.py:278: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:122: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

W0701 14:15:21.753611 140463410571072 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:122: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/utils/metrics.py:172: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0701 14:15:22.113789 140463410571072 deprecation.py:323] From /data/violatang/l2r-paper/code/ULTRA/ultra/utils/metrics.py:172: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:227: The name tf.summary.merge_all is deprecated. Please use tf.compat.v1.summary.merge_all instead.

W0701 14:15:22.411115 140463410571072 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:227: The name tf.summary.merge_all is deprecated. Please use tf.compat.v1.summary.merge_all instead.

WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:229: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

W0701 14:15:22.412094 140463410571072 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:229: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:229: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.

W0701 14:15:22.412262 140463410571072 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/learning_algorithm/pairwise_reg_em.py:229: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.

INFO:tensorflow:Restoring parameters from ./MSLR_10k_letor/tmp_model_singlet_pointwiseem_batch1024/ultra.learning_algorithm.PairwiseRegressionEM.ckpt-2000
I0701 14:15:22.437448 140463410571072 saver.py:1284] Restoring parameters from ./MSLR_10k_letor/tmp_model_singlet_pointwiseem_batch1024/ultra.learning_algorithm.PairwiseRegressionEM.ckpt-2000
WARNING:tensorflow:From main.py:224: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

W0701 14:15:22.803642 140463410571072 module_wrapper.py:139] From main.py:224: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

Reading data in ./MSLR_10k_letor/tmp_data/
Read data from ./MSLR_10k_letor/tmp_data//test in ULTRA format.
Feature reading finish.
List reading finish.
Label reading finish.
Remove 1 invalid queries.
Data reading finish!
Finished reading 1927 queries with lists.
Build Pairwise RegressionEM algorithm.
pointwise_only=True
<ultra.utils.losses_impl.DCGLambdaWeight object at 0x7fc00fc91828>
ranking_model: <class 'ultra.ranking_model.DNN.DNN'>
kwargs: {'rank_list_size': 514, 'forward_only': False}
Reading model parameters from ./MSLR_10k_letor/tmp_model_singlet_pointwiseem_batch1024/ultra.learning_algorithm.PairwiseRegressionEM.ckpt-2000
Create direct label feed with list size 514 with feature size 136
Testing 13% finishedTesting 27% finishedTesting 40% finishedTesting 53% finishedTesting 66% finishedTesting 80% finishedTesting 93% finishedTesting 100% finishedWARNING:tensorflow:From /data/violatang/l2r-paper/code/ULTRA/ultra/utils/data_utils.py:367: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.

W0701 14:15:36.091714 140463410571072 module_wrapper.py:139] From /data/violatang/l2r-paper/code/ULTRA/ultra/utils/data_utils.py:367: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


[Done]
  eval: mrr_3:0.642 mrr_5:0.642 mrr_10:0.642 ndcg_3:0.167 ndcg_5:0.184 ndcg_10:0.220
